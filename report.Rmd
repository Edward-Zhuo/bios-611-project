---
title: "Bios 611 Final report"
author: "Songcheng Zhuo"
output:
  pdf_document:
    latex_engine: xelatex
date: "2022-12-04"
---


## 1. Introduction to the dataset and intended analysis

https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset

Stroke, one type of cardiovascular diseases, is a leading cause of long-term disability and death globally. It can be difficult to detect and requires immediate medical attention. Our understanding of cardiovascular diseases is still relatively primitive, and only a relatively limited amount of prevention and intervention methods are available. 

The conventional risk factors associated with strokes includes high blood pressure, high cholesterol, diabetes, coronary artery diseases and many other chronic diseases. The chosen dataset contains not only many of these risk factors, but also contains some novel attributes, like marriage status, work types (public, private, or self-employed) and residence types (urban and rural). It is interesting to explore if these unconventional attributes would have any contribution to predicting one’s likelihood of getting a stoke. 

A data cleaning step and explorative data analysis (EDA) will be performed first to see the structure of the dataset, the levels of the discrete (categorical) variables, and the distribution of the continuous variables. Also, data visualization could help to identify strong relationship between the covariates, if any. After performing an initial explorative data analysis and visualization, the dataset is analyzed with Linear Discriminant Analysis, Logistic regression, and AdaBoost. The fit is then compared and discussed.  We can then see if the interesting novel attributes truly have an influence or not.


## 2.1 Data cleaning and exploration

The dataset contains the following 12 variables: id, gender, age, hypertension, heart_disease, ever_married, work_type, Residence_type, avg_glucose_level, bmi, smoking_status, stroke.

Let us first take a look at the discrete (categorical) covariates. For the conventional explanatory variables, we have gender, hypertension, and heart disease as dichotomous corvariates. There are 2994 females, 2115 males. There are 4611 without hypertension, 498 with hypertension. There are 4833 without heart disease, 276 with heart disease. For the polytomous smoking status, 884 formerly smoked, 1892 never smoked, 789 smokes, and 1544 are unknown. 

For the non-conventional explanatory variables, we have marriage and residence type as dichotomous corvariates. 1756 never have marriage, 3353 have. 2513 live in rural area, and 2596 live in urban area. For the polytomous job type 687 are children, 657 have government jobs, 22 never worked, 2924 work for private enterprise, and 819 are self-employed.

Let us then take a look at the continuous covariates. For the avaerage blood glucose level, the minimum is 55.12 and the maximum is 271.74. The median is 91.88, which is clearly less than the mean 106.14, indicating that the distribution is right skewed. For the body mass index, the minimum is 10.3 and the maximum is 97.6. The median is 28.1, which is slighly less than the mean 28.89, indicating that the distribution is a little right skewed. There is also 201 NA in the bmi data. For the age, the minimum is 0.08 and the maximum is 82. The median is 45, which is slightly larger than the mean 43.23, indicating that the distribution is left skewed. 

Finally, for the response variable, 249 people in the dataset have stroke, while 4860 do not. 

## 2.2 Data visualization

Let us then visualize the covariates. The following set of figures visualize the distribution of the discrete (first 7) and continuous (last 3) covariates, respectively. The proportion of having stroke is also indicated for each level of the corvariates in the figures.

![variables visulization](figures/variable_distributions.png)

Then let us plot a correction chart of the explanatory variables together with the response variables, from which we could confirm that the conventional explanatory variables like age, hypertension, heart disease, average blood glucose level, body mass index, and smoking status have a statistically significant correlation with the stroke outcome as expected. Furthermore, it seems that two of the three novel attributes (marriage status and work type) also have significant correlation, while residence type does not. The findings from Principle Component Analysis is similar.

![variables correlation](figures/stroke_variables.png)
![pca analysis](figures/pca.png)






## 3.1 Model fitting
We separate the data randomly into training (0.75) and testing (0.25) sets, and then use three methods (Linear Discriminant Analysis, Logistic regression, and AdaBoost) to learn and then predict the data. 



## 3.2 Model diagnostics
Ploting the ROC curves generated by these three different methods, and calculate the respective Area Under Curve, we get similar results (which is written into the file 'data_analysis.txt'). All three methods will have AUC value 0.8-0.9, which is excellent. But no one is siginificantly better than another. Furthermore, using stepwise variable selection in the logistic regeression model shows that besides three essential conventional corvariates (hypertension, avg_glucose_level, and age) that are always selected, other conventional corvariates (smoking status in seed 319, heart disease in seed 295) and some of the novel attributes (say, work type and residence type in seed 359) are also selected.



![roc curves](figures/roc.png)
 
## 4. Conclussion and discussion
For our dataset, two of the novel attributes (work type and marriage status) seem to have a significant correlation with the dichotomous stroke outcome during the explorative data analysis stage. The variable selection procedure in logistic regression most often picks some of the conventional variables as important predictors: smoking status(seed 319) heart disease(seed 295), hypertension, avg_glucose_level, and age, with the last three always being selected. However, for some seeds (seed 359), work type and residence type are also being selected，which indicates these novel attributes may indeed have some importance in the stroke outcome. This is an interesting result and worth further looking into with larger and more balanced dataset. (The dataset is heavily unbalanced, with only 5% having stroke outcome.) Also, it is worth noting that for analysis of this dataset, the three methods (LDA, Logistic regression, and Adaboost) have similar power in prediction.


## 5. Reference
::: {#citeproc_bib_item_1}
Vincent-Toups. *[datasci611]* (<https://github.com/Vincent-Toups/datasci611>)
:::
::: {#citeproc_bib_item_2}
Kaggle. *[Stroke Prediction Dataset]* (<https://www.kaggle.com/datasets/fedesoriano/stroke-prediction-dataset?datasetId=1120859&language=R>)
:::


